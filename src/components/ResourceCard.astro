---
import type { Resource } from "../lib/resources";
import {
	getResourceUrl,
	TYPE_LABELS,
	estimateReadingTime,
	formatDate,
} from "../lib/resources";

interface Props {
	resource: Resource;
	showTags?: boolean;
}

const { resource, showTags = false } = Astro.props;
const url = getResourceUrl(resource);
const readingTime = resource.body ? estimateReadingTime(resource.body) : 1;
---

<a href={url} class="resource-card block group">
	<article class="h-full border border-slate-100 border-l-[3px] border-l-accent/40 rounded-xl pl-6 pr-6 py-5 hover:border-l-accent hover:border-slate-200 hover:shadow-md hover:-translate-y-0.5 transition-all duration-200">
		<div class="flex items-start justify-between gap-4">
			<div class="flex-1 min-w-0">
				<div class="flex flex-wrap items-center gap-2 mb-2">
					<span class="text-xs font-medium uppercase tracking-wider px-2 py-0.5 bg-accent/10 text-accent rounded">
						{TYPE_LABELS[resource.data.type]}
					</span>
					{resource.data.date && (
						<>
							<time datetime={resource.data.date} class="text-xs text-ink/40">{formatDate(resource.data.date)}</time>
							<span class="text-xs text-ink/25">&middot;</span>
						</>
					)}
					<span class="text-xs text-ink/40">{readingTime} min read</span>
				</div>
				<h3 class="text-lg font-semibold text-ink group-hover:text-accent transition-colors mb-1">
					{resource.data.title}
				</h3>
				{resource.data.description && (
					<p class="text-sm text-ink/60 line-clamp-2 leading-relaxed">{resource.data.description}</p>
				)}
				{showTags && resource.data.tags.length > 0 && (
					<div class="flex flex-wrap gap-2 mt-3">
						{resource.data.tags.map((tag) => (
							<span class="text-xs px-2 py-0.5 bg-slate-100 text-ink/60 rounded">{tag}</span>
						))}
					</div>
				)}
			</div>
			<span class="text-ink/20 group-hover:text-accent group-hover:translate-x-1 transition-all duration-200 mt-1 shrink-0" aria-hidden="true">
				<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
				</svg>
			</span>
		</div>
	</article>
</a>
