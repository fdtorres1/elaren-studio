---
import { PLANS, formatPrice, formatBilling } from '../../lib/pricing';

interface Props {
	variant?: "stacked" | "stepped";
}

const { variant = "stacked" } = Astro.props;

const launch = PLANS.launch;
const starter = PLANS.starter;
const carePlus = PLANS.carePlus;
---

<section id="pricing" class={variant === "stepped"
	? "relative py-16 md:py-24 overflow-hidden"
	: "bg-paper py-16 md:py-24"
} style={variant === "stepped" ? "background-color: #eef2f6;" : undefined}>
	<div class={variant === "stepped" ? "container relative z-10" : "container"}>
		<div class="max-w-3xl mx-auto">
			<p class="text-sm font-medium text-accent uppercase tracking-wider mb-3">
				{variant === "stepped" ? "Pricing path" : "Pricing"}
			</p>
			<h2 class="text-2xl md:text-3xl font-semibold mb-3 text-ink">
				{variant === "stepped" ? "Two steps. No hidden fees." : "Simple, transparent pricing"}
			</h2>
			<p class="text-ink/70 mb-8">
				{variant === "stepped" ? (
					<>View full <a href="/pricing" class="text-accent font-medium hover:underline">pricing details</a>.</>
				) : (
					<><strong>How it works:</strong> one-time launch fee first, then choose the monthly support level that fits your practice. View full <a href="/pricing" class="text-accent font-medium hover:underline">pricing details</a>.</>
				)}
			</p>

			{variant === "stepped" ? (
				<>
					<div class="mb-8">
						<div class="flex items-center gap-3 mb-4">
							<span class="flex-shrink-0 w-8 h-8 bg-accent text-paper rounded-full flex items-center justify-center text-sm font-bold">1</span>
							<h3 class="text-lg font-semibold text-ink">{launch.name} â€” {formatPrice(launch)} {formatBilling(launch)}</h3>
						</div>
						<p class="text-sm text-ink/70 ml-11">{launch.description}</p>
					</div>
					<div>
						<div class="flex items-center gap-3 mb-4">
							<span class="flex-shrink-0 w-8 h-8 bg-accent text-paper rounded-full flex items-center justify-center text-sm font-bold">2</span>
							<h3 class="text-lg font-semibold text-ink">Choose your monthly support</h3>
						</div>
						<div class="grid grid-cols-1 sm:grid-cols-2 gap-4 ml-11">
							<div class="bg-paper rounded-xl border-2 border-slate-200 p-5 shadow-sm">
								<h4 class="font-semibold text-ink mb-1">{starter.name}</h4>
								<p class="text-2xl font-bold text-ink mb-2">{formatPrice(starter)}<span class="text-sm font-normal text-ink/60">{formatBilling(starter)}</span></p>
								<p class="text-sm text-ink/60">{starter.description}</p>
							</div>
							<div class="bg-paper rounded-xl border-2 border-accent/40 p-5 shadow-md ring-1 ring-accent/20">
								<div class="flex items-center gap-2 mb-1">
									<h4 class="font-semibold text-ink">{carePlus.name}</h4>
									{carePlus.badge && <span class="text-xs font-bold text-accent bg-accent/10 px-2 py-0.5 rounded-full uppercase tracking-wider">{carePlus.badge}</span>}
								</div>
								<p class="text-2xl font-bold text-ink mb-2">{formatPrice(carePlus)}<span class="text-sm font-normal text-ink/60">{formatBilling(carePlus)}</span></p>
								<p class="text-sm text-ink/60">{carePlus.description}</p>
							</div>
						</div>
					</div>
				</>
			) : (
				<div class="space-y-4">
					<div class="bg-paper rounded-xl border-2 border-slate-200 p-6 shadow-sm flex flex-wrap items-baseline justify-between gap-4">
						<div>
							<h3 class="font-semibold text-ink">{launch.name}</h3>
							<p class="text-sm text-ink/60">{launch.description}</p>
						</div>
						<div class="text-right">
							<span class="text-2xl font-bold text-ink">{formatPrice(launch)}</span>
							<span class="text-ink/60 ml-1">{formatBilling(launch)}</span>
						</div>
					</div>
					<div class="bg-paper rounded-xl border-2 border-slate-200 p-6 shadow-sm flex flex-wrap items-baseline justify-between gap-4">
						<div>
							<h3 class="font-semibold text-ink">{starter.name}</h3>
							<p class="text-sm text-ink/60">{starter.description}</p>
						</div>
						<div class="text-right">
							<span class="text-2xl font-bold text-ink">{formatPrice(starter)}</span>
							<span class="text-ink/60 ml-1">{formatBilling(starter)}</span>
						</div>
					</div>
					<div class="bg-paper rounded-xl border-2 border-accent/40 p-6 shadow-md ring-1 ring-accent/20 flex flex-wrap items-baseline justify-between gap-4">
						<div>
							<div class="flex items-center gap-2 mb-1">
								<h3 class="font-semibold text-ink">{carePlus.name}</h3>
								{carePlus.badge && <span class="text-xs font-bold text-accent bg-accent/10 px-2 py-0.5 rounded-full uppercase tracking-wider">{carePlus.badge}</span>}
							</div>
							<p class="text-sm text-ink/60">{carePlus.description}</p>
						</div>
						<div class="text-right">
							<span class="text-2xl font-bold text-ink">{formatPrice(carePlus)}</span>
							<span class="text-ink/60 ml-1">{formatBilling(carePlus)}</span>
						</div>
					</div>
				</div>
			)}
		</div>
	</div>
</section>
